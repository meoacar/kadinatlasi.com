import{f as e,r as a,g as t,b as s,i as l,e as r,J as i,t as n,F as o,j as c,u as d,B as u,C as m,A as p,k as y,w as v,l as x,K as g,m as f,o as b}from"./vendor-CPwFJ_a5.js";import{u as h,a as w}from"./index-BwQsNOTg.js";const k={class:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8"},_={key:0,class:"text-center py-8"},z={key:1,class:"space-y-6"},j={class:"bg-white rounded-lg border border-gray-200 p-6"},Y={class:"flex items-center gap-2 mb-4"},C={key:0,class:"px-2 py-1 bg-yellow-100 text-yellow-800 text-xs rounded-full"},A={key:1,class:"px-2 py-1 bg-red-100 text-red-800 text-xs rounded-full"},D={class:"text-2xl font-bold text-gray-900 mb-4"},S={class:"flex items-center justify-between text-sm text-gray-500 mb-4"},B={class:"flex items-center"},F={class:"w-8 h-8 bg-primary-100 rounded-full flex items-center justify-center mr-3"},G={class:"text-primary-600 font-medium"},R={class:"font-medium text-gray-900"},T={class:"text-right"},$={class:"prose max-w-none"},K={class:"whitespace-pre-wrap"},L={key:0,class:"space-y-4"},V={class:"flex items-center justify-between mb-4"},q={class:"flex items-center"},E={class:"w-8 h-8 bg-primary-100 rounded-full flex items-center justify-center mr-3"},J={class:"text-primary-600 font-medium"},U={class:"font-medium text-gray-900"},H={class:"text-sm text-gray-500"},I={key:0,class:"flex gap-2"},M=["onClick"],N=["onClick"],O={class:"prose max-w-none"},P={class:"whitespace-pre-wrap"},Q={key:1,class:"bg-white rounded-lg border border-gray-200 p-6"},W={class:"flex justify-end"},X=["disabled"],Z={key:2,class:"bg-gray-50 rounded-lg p-6 text-center"},ee={key:3,class:"bg-red-50 rounded-lg p-6 text-center"},ae={class:"pt-6"},te=e({__name:"ForumTopicView",setup(e){const te=g(),se=h(),le=a(null),re=a(!1),ie=a(""),ne=a(!1),oe=async()=>{re.value=!0;try{const e=await w.get(`/forum/topics/${te.params.id}`);e.data.success&&(le.value=e.data.data)}catch(e){console.error("Topic fetch error:",e)}finally{re.value=!1}},ce=async()=>{if(ie.value.trim()){ne.value=!0;try{(await w.post(`/forum/topics/${te.params.id}/posts`,{content:ie.value})).data.success&&(ie.value="",await oe())}catch(e){console.error("Reply submit error:",e)}finally{ne.value=!1}}},de=e=>new Date(e).toLocaleDateString("tr-TR",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"});return t(()=>{oe()}),(e,a)=>{const t=x("RouterLink");return b(),s("div",k,[re.value?(b(),s("div",_,a[1]||(a[1]=[r("div",{class:"text-gray-500"},"Yükleniyor...",-1)]))):le.value?(b(),s("div",z,[r("div",j,[r("div",Y,[le.value.is_pinned?(b(),s("span",C," 📌 Sabitlenmiş ")):l("",!0),le.value.is_locked?(b(),s("span",A," 🔒 Kilitli ")):l("",!0),r("span",{class:"px-2 py-1 text-xs rounded-full",style:i({backgroundColor:le.value.category?.color+"20",color:le.value.category?.color})},n(le.value.category?.name),5)]),r("h1",D,n(le.value.title),1),r("div",S,[r("div",B,[r("div",F,[r("span",G,n(le.value.user?.name?.charAt(0)),1)]),r("div",null,[r("div",R,n(le.value.user?.name),1),r("div",null,n(de(le.value.created_at)),1)])]),r("div",T,[r("div",null,n(le.value.posts_count)+" yanıt",1),r("div",null,n(le.value.views_count)+" görüntüleme",1)])]),r("div",$,[r("p",K,n(le.value.content),1)])]),le.value.posts&&le.value.posts.length>0?(b(),s("div",L,[a[2]||(a[2]=r("h2",{class:"text-xl font-bold text-gray-900"},"Yanıtlar",-1)),(b(!0),s(o,null,c(le.value.posts,e=>(b(),s("div",{key:e.id,class:"bg-white rounded-lg border border-gray-200 p-6"},[r("div",V,[r("div",q,[r("div",E,[r("span",J,n(e.user?.name?.charAt(0)),1)]),r("div",null,[r("div",U,n(e.user?.name),1),r("div",H,n(de(e.created_at)),1)])]),d(se).user?.id===e.user_id?(b(),s("div",I,[r("button",{onClick:a=>(e=>{console.log("Edit post:",e)})(e),class:"text-sm text-blue-600 hover:text-blue-800"}," Düzenle ",8,M),r("button",{onClick:a=>(async e=>{if(confirm("Bu yanıtı silmek istediğinizden emin misiniz?"))try{(await w.delete(`/forum/posts/${e}`)).data.success&&await oe()}catch(a){console.error("Delete post error:",a)}})(e.id),class:"text-sm text-red-600 hover:text-red-800"}," Sil ",8,N)])):l("",!0)]),r("div",O,[r("p",P,n(e.content),1)])]))),128))])):l("",!0),d(se).isAuthenticated&&!le.value.is_locked?(b(),s("div",Q,[a[3]||(a[3]=r("h3",{class:"text-lg font-semibold mb-4"},"Yanıt Yaz",-1)),r("form",{onSubmit:p(ce,["prevent"]),class:"space-y-4"},[u(r("textarea",{"onUpdate:modelValue":a[0]||(a[0]=e=>ie.value=e),rows:"4",placeholder:"Yanıtınızı yazın...",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent resize-none",required:""},null,512),[[m,ie.value]]),r("div",W,[r("button",{type:"submit",disabled:ne.value||!ie.value.trim(),class:"btn-primary disabled:opacity-50"},n(ne.value?"Gönderiliyor...":"Yanıt Gönder"),9,X)])],32)])):d(se).isAuthenticated?le.value.is_locked?(b(),s("div",ee,a[6]||(a[6]=[r("p",{class:"text-red-600"},"Bu konu kilitli, yeni yanıt yazamazsınız",-1)]))):l("",!0):(b(),s("div",Z,[a[5]||(a[5]=r("p",{class:"text-gray-600 mb-4"},"Yanıt yazmak için giriş yapmalısınız",-1)),y(t,{to:"/login",class:"btn-primary"},{default:v(()=>a[4]||(a[4]=[f(" Giriş Yap ",-1)])),_:1,__:[4]})])),r("div",ae,[y(t,{to:"/forum",class:"text-primary-500 hover:text-primary-600"},{default:v(()=>a[7]||(a[7]=[f(" ← Forum'a Dön ",-1)])),_:1,__:[7]})])])):l("",!0)])}}});export{te as default};
